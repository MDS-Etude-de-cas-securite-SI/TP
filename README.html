<!DOCTYPE html>
<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="etude-de-cas-s%C3%A9curit%C3%A9-si-%C2%AB-secu-web-%C2%BB">Etude de cas sécurité SI « secu web »</h1>
<p><a href="https://teams.microsoft.com/l/file/e47613ce-619b-432e-82dd-377b4b5b75b5?tenantId=8a2f18a9-8f0e-4f76-a585-9b07b3a38dea&amp;fileType=pdf&amp;objectUrl=https%3A%2F%2Feduservices.sharepoint.com%2Fsites%2FM1ESI333%2FDocuments%20partages%2FSECURISATION%20DU%20CODE%2FNFConsulting_secuWeb%20I1%20MDS%20Rennes.pdf&amp;baseUrl=https%3A%2F%2Feduservices.sharepoint.com%2Fsites%2FM1ESI333&amp;serviceName=teams&amp;threadId=19:44220b72aa934a5ca67aba8e06c84dc7@thread.tacv2&amp;messageId=1614673973035&amp;groupId=b164e3e9-dad8-4e03-badf-910b4c64802a">consignes (pdf)</a></p>
<ul>
<li>
<p>Serveur</p>
<ul>
<li><input type="checkbox" id="checkbox0" checked="true"><label for="checkbox0">load-balancing</label></li>
<li><input type="checkbox" id="checkbox1" checked="true"><label for="checkbox1">HTTP proxy</label></li>
<li><input type="checkbox" id="checkbox2" checked="true"><label for="checkbox2">HTTPS</label></li>
<li><input type="checkbox" id="checkbox3" checked="true"><label for="checkbox3">Certificat auto-signé</label></li>
</ul>
</li>
<li>
<p>Base de données</p>
<ul>
<li><input type="checkbox" id="checkbox4"><label for="checkbox4">création</label></li>
<li><input type="checkbox" id="checkbox5"><label for="checkbox5"></label><em>chiffrement  de  la  base</em></li>
</ul>
</li>
<li>
<p>WAF</p>
<ul>
<li><input type="checkbox" id="checkbox6"><label for="checkbox6">protection contre : </label><em>utilisation par un adresse IP non autorisées</em></li>
<li><input type="checkbox" id="checkbox7" checked="true"><label for="checkbox7">documentation</label></li>
</ul>
</li>
<li>
<p>Souhaitable :</p>
<ul>
<li><input type="checkbox" id="checkbox8"><label for="checkbox8"> virtualisation  ou  dockerisation</label></li>
</ul>
</li>
</ul>
<h2 id="sommaire">Sommaire</h2>
<ul>
<li><a href="#architecture-du-serveur">Architecture du serveur</a></li>
<li><a href="#waf">WAF</a>
<ul>
<li><a href="#nginx-plus">NGINX Plus</a>
<ul>
<li><a href="#distributions-support%C3%A9es">Distributions supportées</a></li>
<li><a href="#fonctionnement">Fonctionnement</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="architecture-du-serveur">Architecture du serveur</h2>
<p>L'application tourne en NodeJS et plusieurs instances sont créées à l'aide de PM2. NGinx est utilisé en tant que reverse proxy et permet de répartir la charge en redirigeant les utilisateurs vers une instance ou une autre à l'aide de l'algorithme &quot;Round-robin&quot; (tourniquet), la charge est alors répartie de manière uniforme et prend en compte les poids (si définis). D'autre méthodes de répartition de charge peuvent être configurés : &quot;Least connections&quot;, &quot;IP Hash&quot;, &quot;Generic hash&quot;, &quot;Least time&quot;.</p>
<p><img src="./server_config.svg" alt=""></p>
<p>Le serveur est accessible en HTTP et en HTTPS, bien que le certificat pour le HTTPS soit auto-signé. (Aucun autorité de certification n'a validé notre certificat.)</p>
<h2 id="waf">WAF</h2>
<blockquote>
<p>Le repo étant basé pour une utilisation Windows, l'application n'intègre pas de WAF (<a href="#distributions-support%C3%A9es">raison</a>).
À défaut, voici une explication du WAF et d'une possible intégration :</p>
</blockquote>
<p>Un WAF (Web Application Firewall) sert à protéger les applications web en surveillant et filtrant le trafic HTTP avant même l'accès à l'application.
Il agit comme une sorte de bouclier pour l’application et protège des attaques XSS, d’inclusion de fichier et d’injection SQL.</p>
<p><img src="https://avinetworks.com/wp-content/uploads/2019/03/web-application-firewall-diagram.svg" alt=""></p>
<p>Il existe deux types de fonctionnement du WAF, il peut-être basé sur une liste noire (<em>ModSecurity de Nginx</em>) ou bien sur liste blanche (<em>NAXSI</em>).</p>
<p>S’il est basé sur liste noire, le WAF filtrera le trafic HTTP sur une base donnée, appelée signature, c’est-à-dire qu’à l’aide d’une regex représentant les différents types d’attaque possible, il saura refuser l'entrée aux requêtes reflétant un trafic dangereux.</p>
<p>À l’inverse, un WAF basé sur liste blanche quant-à lui laissera seulement les requêtes autorisées présentes dans la signature.</p>
<p>Un WAF possède d’autres caractéristiques comme :</p>
<ul>
<li>Prévenir les attaques et les accès non autorisés</li>
<li>Prévention de fuite de données</li>
<li>Empêcher ou détecter la falsification de jetons de session, par exemple en chiffrant des cookies de session, des champs de formulaire masqués ou en utilisant d'autres méthodes pouvant être utilisées par ceux qui suivent la session</li>
</ul>
<blockquote>
<p>source: https://fr.wikipedia.org/wiki/Web_application_firewall#Les_caract.C3.A9ristiques_du_WAF</p>
</blockquote>
<h3 id="nginx-plus">NGINX Plus</h3>
<p>NGINX Plus fournit une panoplie de fonctionnalités intégrées :</p>
<ul>
<li>load balancer</li>
<li>content cache</li>
<li>bew server</li>
<li>API gateway</li>
<li>microservice proxy</li>
</ul>
<p>ainsi qu'<em>NGINX App Protect</em> incluant le WAF basé sur la technologie de sécurité de <a href="https://www.f5.com/">F5</a> (<em>NGINX ModSecurity WAF</em>).</p>
<h4 id="distributions-support%C3%A9es">Distributions supportées</h4>
<ul>
<li>Alpine Linux</li>
<li>Amazon Linux</li>
<li>CentOs</li>
<li>Debian</li>
<li>FreeBSD</li>
<li>SLES</li>
<li>Ubuntu</li>
</ul>
<h4 id="fonctionnement">Fonctionnement</h4>
<p>(Voir : https://docs.nginx.com/nginx-waf/admin-guide/nginx-plus-modsecurity-waf-installation-logging/#protecting-the-demo-web-application)</p>
<p>Pour utiliser <em>NGINX ModSecurity WAF</em> il faut modifier le fichier de configuration du reverse proxy en activant l'addon (<code>modsecurity on</code>) et en spécifiant l'adresse du fichier de configuration du WAF (<code>modsecurity_rules_file /etc/...</code>)
L'exemple fournit par NGINX :</p>
<pre class="hljs"><code><div><span class="hljs-attribute">server</span> {
    <span class="hljs-attribute"><span class="hljs-nomarkup">listen</span></span> 80;
    <span class="hljs-attribute">modsecurity</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">modsecurity_rules_file</span> /etc/nginx/modsec/main.conf;
    <span class="hljs-attribute">location</span> / {
        <span class="hljs-attribute">proxy_pass</span> http://localhost:8085;
        <span class="hljs-attribute">proxy_set_header</span> Host $host;
    }
}
</div></code></pre>
<br>
<hr>
<p>PS : Amis Windows s’abstenir.</p>
<style> /* Auhor: Cédric B. GitHub: https://github.com/CedricBardaine Date: 2021 */ html { background-color: white; /* background-color: #FFFEEE; */ } body { color: black; text-align: justify; } code { background-color: black; color: lightgreen; padding: 2px 4px; /* Y X */ } pre code { padding: unset; } em { color: brown; } blockquote { border-color: brown; background-color: #EEEEEE !important; } blockquote p { background-color: inherit } /* p:hover { background-color: #FFFEEE; padding-left: 4px; } */ h1, h2, h3, h4, h5, h6 { font-size: 64px; padding: 32px 0px 4px 0px; /* top right bottom left */ text-align: center; } h2, h3, h4, h5, h6 { font-size: 32px; text-indent: 8px; text-decoration: underline; text-align: inherit; } h3, h4, h5, h6 { font-size: 28px; } h4, h5, h6 { font-size: 28px; } h5, h6 { font-size: 24px; } h6 { font-size: 20px; } img { border: solid 1px black; /* margin: 4px; */ } </style>
</body>
</html>
